# مستندات API سیستم رزرو غذا (Food Reservation System)


**آدرس پایه (Base URL):** `http://localhost:8080`  
**فرمت تاریخ‌ها:** ISO 8601 (مثال: `2025-12-17T14:30:00`)


## 1. مدیریت غذاها

این بخش برای مدیریت منوی رستوران که به کاربران در ربات تلگرام نمایش داده می‌شود، کاربرد دارد.

### ۱.۱. افزودن غذای جدید
یک غذای جدید به منو اضافه می‌کند.

- **آدرس:** `/api/admin/foods`
- **متد:** `POST`
- **هدر:** `Content-Type: application/json`

**بدنه درخواست (Request Body):**
```json
{
  "name": "پیتزا مخصوص",
  "price": 250000
}
```

**پاسخ موفق (200 OK):**
```json
{
  "id": 1,
  "name": "پیتزا مخصوص",
  "price": 250000,
  "active": true
}
```

---

### ۱.۲. حذف (غیرفعال کردن) غذا
این متد غذا را از دیتابیس **پاک نمی‌کند** (برای حفظ یکپارچگی داده‌های سفارش‌های قبلی)، بلکه وضعیت آن را به غیرفعال (`active = false`) تغییر می‌دهد تا دیگر در منوی ربات نمایش داده نشود.

- **آدرس:** `/api/admin/foods/{id}`
- **متد:** `DELETE`
- **پارامتر مسیر (Path Variable):**
    - `id`: شناسه یکتای غذا (مثلاً `1`)

**پاسخ موفق (200 OK):**
```text
Food deactivated successfully.
```

---

## 2. مدیریت و گزارش سفارش‌ها

این بخش برای دریافت گزارش‌های مدیریتی و تغییر وضعیت سفارش‌ها (مثلاً وقتی غذا آماده می‌شود) استفاده می‌شود.

### ۲.۱. جستجو و گزارش‌گیری سفارش‌ها
این اندپوینت امکان فیلتر کردن سفارش‌ها بر اساس **کاربر**، **وضعیت** و **بازه زمانی** را فراهم می‌کند. تمام پارامترها اختیاری هستند؛ اگر پارامتری ارسال نشود، آن فیلتر اعمال نمی‌گردد.

- **آدرس:** `/api/admin/orders`
- **متد:** `GET`

**پارامترهای کوئری (Query Parameters):**

| نام پارامتر | نوع داده | وضعیت | توضیحات | مثال |
| :--- | :--- | :--- | :--- | :--- |
| `telegramId` | `Long` | اختیاری | شناسه عددی کاربر در تلگرام | `123456789` |
| `status` | `String` | اختیاری | وضعیت سفارش (مقادیر مجاز در بخش 3) | `REGISTERED` |
| `from` | `DateTime` | اختیاری | تاریخ شروع گزارش (فرمت ISO) | `2025-12-01T00:00:00` |
| `to` | `DateTime` | اختیاری | تاریخ پایان گزارش (فرمت ISO) | `2025-12-30T23:59:59` |

**مثال درخواست (ترکیبی):**
```http
GET /api/admin/orders?status=REGISTERED&telegramId=123456789&from=2025-12-17T00:00:00
```

**پاسخ موفق (200 OK):**
```json
[
  {
    "id": 15,
    "user": {
      "id": 9,
      "telegramId": 123456789,
      "username": "ali_user",
      "firstName": "Ali",
      "createdAt": "2025-12-10T10:00:00"
    },
    "food": {
      "id": 11,
      "name": "همبرگر ذغالی",
      "price": 180000,
      "active": true
    },
    "status": "REGISTERED",
    "orderedAt": "2025-12-17T20:35:00"
  }
]
```

---

### ۲.۲. تغییر وضعیت سفارش
از این اندپوینت برای به‌روزرسانی وضعیت سفارش (مثلاً تایید سفارش یا اعلام آماده بودن غذا) استفاده می‌شود.

- **آدرس:** `/api/admin/orders/{id}/status`
- **متد:** `PUT`
- **پارامتر مسیر (Path Variable):**
    - `id`: شناسه سفارش.
- **پارامتر کوئری (Query Parameter):**
    - `newStatus`: وضعیت جدید (الزامی).

**مثال درخواست:**
```http
PUT /api/admin/orders/15/status?newStatus=READY
```

**پاسخ موفق (200 OK):**
```json
{
  "id": 15,
  "status": "READY",
  "orderedAt": "2025-12-17T20:35:00",
  "user": { ... },
  "food": { ... }
}
```

---

## 3. مدل‌های داده (Enums)

### وضعیت سفارش (`OrderStatus`)
مقادیر مجاز برای فیلدهای `status` و `newStatus` عبارتند از:

| مقدار | معنی | کاربرد |
| :--- | :--- | :--- |
| **`REGISTERED`** | ثبت شده | وضعیت پیش‌فرض هنگام ثبت سفارش توسط کاربر. |
| **`REJECTED`** | رد شده | زمانی که رستوران امکان تهیه غذا را ندارد. |
| **`READY`** | آماده تحویل | زمانی که غذا پخته شده و بسته‌بندی شده است. |
| **`DELIVERED`** | تحویل شده | زمانی که غذا به دست مشتری رسیده است. |